import os
import datetime

def initialize_file():
    if not os.path.exists('expenses.txt'):
        with open('expenses.txt','w') as file:
            file.write('Date,Amount,Category,Description\n')

def add_expense(date, amount, category, description):
    with open('expenses.txt', 'a') as file:
        file.write(f'{date},{amount},{category},{description}\n')
    print('âœ… Expense added!')

def view_expenses():
    with open('expenses.txt', 'r') as file:
        lines = file.readlines()
        if len(lines) > 1:
            print("\nğŸ“‹ All Expenses:")
            print(lines[0].strip())
            for line in lines[1:]:
                print(line.strip())
        else:
            print("âŒ No expenses found!")

def filter_expenses(filter_by, filter_value):
    with open('expenses.txt', 'r') as file:
        lines = file.readlines()
        print(f"\nğŸ” Filtered by {filter_by}: {filter_value}")
        print(lines[0].strip())
        for line in lines[1:]:
            data = line.strip().split(',')
            if (filter_by == 'date' and filter_value == data[0]) or \
               (filter_by == 'category' and filter_value == data[2]):
                print(line.strip())

def delete_expense(date, amount, category, description):
    lines = []
    with open('expenses.txt', 'r') as file:
        lines = file.readlines()
    with open('expenses.txt', 'w') as file:
        for line in lines:
            if line.strip() != f'{date},{amount},{category},{description}':
                file.write(line)
    print('ğŸ—‘ï¸ Expense deleted!')

def monthly_summary():
    current_month = datetime.datetime.now().strftime('%Y-%m')
    total_expense = 0.0
    category_expense = {}
    with open('expenses.txt', 'r') as file:
        lines = file.readlines()
        for line in lines[1:]:
            data = line.strip().split(',')
            if data[0].startswith(current_month):
                amount = float(data[1])
                category = data[2]
                total_expense += amount
                if category in category_expense:
                    category_expense[category] += amount
                else:
                    category_expense[category] = amount
    print(f"\nğŸ’° Current Month ({current_month}): â‚¹{total_expense:.2f}")
    for category, amount in category_expense.items():
        print(f"  {category}: â‚¹{amount:.2f}")

def main():
    initialize_file()
    print("ğŸ’¸ Personal Expense Tracker".center(50, '='))
    
    while True:
        print("\nğŸ“‚ Menu:")
        print("1. â• Add Expense")
        print("2. ğŸ“‹ View All")
        print("3. ğŸ” Filter")
        print("4. ğŸ—‘ï¸ Delete")
        print("5. ğŸ“Š Monthly Summary")
        print("6. âŒ Exit")
        
        choice = input("\nEnter choice (1-6): ")
        
        if choice == '1':
            date = input("Date (YYYY-MM-DD): ")
            amount = input("Amount: ")
            category = input("Category (Food/Travel/Shopping): ")
            description = input("Description: ")
            add_expense(date, amount, category, description)
            
        elif choice == '2':
            view_expenses()
            
        elif choice == '3':
            filter_by = input("Filter by (date/category): ").lower()
            filter_value = input(f"Enter {filter_by}: ")
            filter_expenses(filter_by, filter_value)
            
        elif choice == '4':
            date = input("Date (YYYY-MM-DD): ")
            amount = input("Amount: ")
            category = input("Category: ")
            description = input("Description: ")
            delete_expense(date, amount, category, description)
            
        elif choice == '5':
            monthly_summary()
            
        elif choice == '6':
            print("ğŸ‘‹ Thanks for using Expense Tracker!")
            break
            
        else:
            print("âŒ Invalid option!")

if __name__ == '__main__':
    main()
